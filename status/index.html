<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>virtauto.OS — Live System Status</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Global Styles -->
  <link rel="stylesheet" href="../assets/styles.css" />
  <link rel="stylesheet" href="../assets/styles_unify.css" />

  <!-- Site JS (Burger, Nav etc.) -->
  <script defer src="../assets/site.js"></script>

  <style>
    .status-box { margin-top: 2rem; }
    .status-row { margin: .4rem 0; }
    .pill {
      display: inline-block;
      padding: .2rem .6rem;
      border-radius: 999px;
      font-size: .8rem;
      font-weight: 600;
    }
    .ok { background:#1eaa6e; color:#fff; }
    .warn { background:#e0a800; color:#000; }
    .crit { background:#c0392b; color:#fff; }
  </style>
</head>

<body>

<!-- HEADER (identisch zur Website) -->
<header class="header">
  <div class="container nav">
    <a class="brand" href="../index.html">virtauto<span class="badge">OS</span></a>

    <nav class="menu" id="menu">
      <a href="../index.html">Home</a>
      <a href="../agents.html">Agents</a>
      <a href="../architecture.html">Architecture</a>
      <a href="/status/" class="active">Status</a>
      <a href="../contact.html">Contact</a>
      <a class="cta" href="../solutions.html#george">Meet GEORGE</a>
    </nav>

    <button class="burger" aria-label="Menu" type="button">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<main class="container">

  <h1>virtauto.OS — Live System Status</h1>

  <div class="status-box">
    <div class="status-row">Truth source: <strong id="truth">—</strong></div>
    <div class="status-row">Generated: <strong id="generated">—</strong></div>
    <div class="status-row">Environment: <strong id="env">—</strong></div>
    <div class="status-row">Signal:
      <span id="signal" class="pill warn">UNKNOWN</span>
    </div>
  </div>

</main>

<script>
(async function () {
  try {
    const res = await fetch("/global_state.json", { cache: "no-store" });
    if (!res.ok) throw new Error("Fetch failed");

    const gs = await res.json();

    document.getElementById("truth").textContent = "global_state.json";
    document.getElementById("generated").textContent =
      gs.generated_at || gs.generatedAt || "—";
    document.getElementById("env").textContent =
      gs.environment || "—";

    const rawSignal =
      (gs.health && gs.health.signal) || "UNKNOWN";

    const pill = document.getElementById("signal");
    pill.textContent = rawSignal;

    pill.classList.remove("ok", "warn", "crit");
    if (rawSignal === "GREEN") pill.classList.add("ok");
    else if (rawSignal === "YELLOW") pill.classList.add("warn");
    else pill.classList.add("crit");

  } catch (e) {
    const pill = document.getElementById("signal");
    pill.textContent = "ERROR";
    pill.classList.remove("ok", "warn");
    pill.classList.add("crit");
    console.error("Status load failed:", e);
  }
})();
</script>

</body>
</html>