<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>virtauto.OS — Live System Status</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Global layout -->
  <link rel="stylesheet" href="../assets/styles.css" />
  <link rel="stylesheet" href="../assets/styles_unify.css" />

  <!-- Status-only styles -->
  <style>
    main { max-width: 1100px; margin: 0 auto; padding: 40px 20px; }
    h1 { margin-bottom: 24px; }
    .kv { margin: 6px 0; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; font-size:12px; }
    .ok { background:#1f7a4f; }
    .warn { background:#8a6d1d; }
    .crit { background:#8a1d1d; }
    section { margin-top: 40px; }
  </style>
</head>

<body>

<!-- ✅ GLOBAL HEADER (identisch zu allen anderen Seiten) -->
<header class="header">
  <div class="container nav">
    <a class="brand" href="../index.html">virtauto<span class="badge">OS</span></a>

    <nav class="menu">
      <a href="../index.html">Home</a>
      <a href="../agents.html">Agents</a>
      <a href="../architecture.html">Architecture</a>
      <a href="/status/" class="active">Status</a>
      <a href="../contact.html">Contact</a>
      <a class="cta" href="../solutions.html#george">Meet GEORGE</a>
    </nav>

    <div class="agent-flag">
      <a href="/status/" class="agent-link">Agentic Website</a>
    </div>
  </div>
</header>

<main>
  <h1>virtauto.OS — Live System Status</h1>

  <div id="meta">
    <div class="kv"><strong>Truth source:</strong> <span id="truth">—</span></div>
    <div class="kv"><strong>Generated:</strong> <span id="generated">—</span></div>
    <div class="kv"><strong>Environment:</strong> <span id="env">—</span></div>
    <div class="kv"><strong>Signal:</strong> <span id="signal" class="pill">—</span></div>
  </div>

  <section>
    <h2>Agents</h2>
    <ul id="agents"></ul>
  </section>

  <section>
    <h2>Guards</h2>
    <div id="freshness">—</div>
  </section>
</main>

<script>
const PATH = "/ops/reports/global_state.json";

function cls(sig){
  sig = (sig||"").toUpperCase();
  if(sig.includes("GREEN")||sig.includes("OK")) return "pill ok";
  if(sig.includes("YELLOW")||sig.includes("WARN")) return "pill warn";
  return "pill crit";
}

fetch(PATH,{cache:"no-store"})
.then(r=>r.json())
.then(gs=>{
  document.getElementById("truth").textContent = "global_state.json";
  document.getElementById("generated").textContent = gs.generated_at || "—";
  document.getElementById("env").textContent = gs.environment || "—";

  const sig = (gs.health && gs.health.signal) || "UNKNOWN";
  const sp = document.getElementById("signal");
  sp.textContent = sig;
  sp.className = cls(sig);

  const ul = document.getElementById("agents");
  Object.entries(gs.agents||{}).forEach(([k,v])=>{
    const li = document.createElement("li");
    li.textContent = `${k}: ${v.state||"—"}`;
    ul.appendChild(li);
  });

  document.getElementById("freshness").textContent =
    gs.generated_at ? "updated " + gs.generated_at : "—";
})
.catch(e=>{
  document.getElementById("signal").textContent = "ERROR";
  document.getElementById("signal").className = "pill crit";
});
</script>

</body>
</html>