version: 1
last_updated: "2025-12-03T08:45:00Z"

meta:
  description: >
    GEORGE Orchestrator Rules V1.0 for virtauto.de.
    Simple event-based routing between Self-Agents.
  owner: "virtauto.OS"
  tags: ["george", "orchestrator", "routing", "self-agents"]

rules:
  # ------------------------------------------------------------------
  # 1) Fehler & Warnungen -> Self-Guardian
  # ------------------------------------------------------------------
  - id: "guard-001"
    description: "Route all error/failure events to the Self-Guardian Agent."
    match:
      event: ["error", "failed", "failure"]
    action:
      target_agent: "self_guardian"
      intent: "investigate_failure"
      message: "GEORGE detected a failing workflow and requests a root-cause analysis."

  - id: "guard-002"
    description: "Route pipeline warnings to Self-Guardian for follow-up."
    match:
      event: ["warning", "degraded"]
    action:
      target_agent: "self_guardian"
      intent: "review_warning"
      message: "GEORGE noticed a degraded or warning state and asks for a review."

  # ------------------------------------------------------------------
  # 2) Self-Audit -> Content Agent
  # ------------------------------------------------------------------
  - id: "content-001"
    description: "If the Self-Audit Agent completes successfully, trigger the Content Agent."
    match:
      agent: "self_audit"
      event: ["completed", "report_ready"]
    action:
      target_agent: "self_content"
      intent: "generate_dashboard_copy"
      message: "Use the latest audit findings to update dashboard texts and status snippets."

  # ------------------------------------------------------------------
  # 3) Self-Content -> Deploy Agent (wenn neue Inhalte fertig)
  # ------------------------------------------------------------------
  - id: "deploy-001"
    description: "If the Content Agent marks content as ready, trigger a deploy."
    match:
      agent: "self_content"
      event: ["content_ready", "page_updated"]
    action:
      target_agent: "deploy_agent"
      intent: "deploy_site_update"
      message: "New content is ready – please trigger a safe production deployment."

  # ------------------------------------------------------------------
  # 4) RAG Embedding Builder -> Knowledge Agent
  # ------------------------------------------------------------------
  - id: "knowledge-001"
    description: "When RAG embeddings are updated, notify the Knowledge Agent."
    match:
      agent: "rag_embedding_builder"
      event: ["embeddings_updated", "knowledge_index_refreshed"]
    action:
      target_agent: "knowledge_agent"
      intent: "reload_index"
      message: "New embeddings have been generated. Reload or re-index the RAG knowledge base."

  # ------------------------------------------------------------------
  # 5) Site-Audit / External Monitoring -> Self-Guardian
  # ------------------------------------------------------------------
  - id: "guard-003"
    description: "Route external site-audit issues to Self-Guardian."
    match:
      agent: ["site_audit", "external_monitor"]
      event: ["issue_detected", "uptime_alert"]
    action:
      target_agent: "self_guardian"
      intent: "handle_external_issue"
      message: "External monitoring detected issues. Please check uptime, performance, or SEO."

  # 6) Website Monitoring -> Content Agent (Status-Update)
  # -----------------------------------------------------
  - id: "monitor-001"
    description: "When website monitoring reports status_ok, trigger the Content Agent to create a status update."
    match:
      agent: "website_monitoring"
      event: "status_ok"
    action:
      target_agent: "self_content"       # passt zu deiner bestehenden content-Regel
      intent: "create_status_update"
      message: "Website status is OK. Generate a short system status text for virtauto.de based on the current healthy state."


  # ------------------------------------------------------------------
  # 7) Default: Alles andere erstmal nur loggen (No-Op)
  #    (GEORGE schreibt dann nur ein route-Event ohne Folgewirkung)
  # ------------------------------------------------------------------
  - id: "noop-001"
    description: "Catch-all for unknown events (for observability only)."
    match: {}
    action:
      target_agent: "activity_log"
      intent: "record_event"
      message: "Unknown event type – record in activity feed for later analysis."
