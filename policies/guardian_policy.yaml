version: 1.0
last_updated: "2025-11-04T09:00:00Z"

policies:
  - id: enforce_https
    description: All requests must use HTTPS.
    type: security
    pattern: "^https://"
    action: block
    severity: high

  - id: meta_description
    description: Pages must have meta description and title.
    selector: "meta[name='description'], title"
    required: true
    severity: medium

  - id: robots_sitemap
    description: Ensure robots.txt and sitemap.xml exist and are valid.
    paths:
      - /robots.txt
      - /sitemap.xml
    must_exist: true
    severity: medium

version: 1.0
agent: self_guardian
updated: "2025-11-04T00:00:00Z"

rules:
  - id: security_headers
    type: headers
    url: "https://www.virtauto.de/"
    must_include:
      - "Strict-Transport-Security"
      - "Content-Security-Policy"
      - "X-Content-Type-Options"
    severity: high
    rollback_on: true

  - id: robots_sitemap
    type: files
    paths:
      - /robots.txt
      - /sitemap.xml
    must_exist: true
    severity: medium
    rollback_on: false

  - id: mixed_content
    type: scan
    pattern: "http://"
    scope: public/
    severity: critical
    rollback_on: true

  - id: https_only
    type: header
    url: "https://www.virtauto.de"
    must_include:
      - "Strict-Transport-Security"
    severity: high
    rollback_on: true

  - id: meta_tags
    type: html
    url: "https://www.virtauto.de"
    selector: "head"
    must_include_meta:
      - name: "description"
      - name: "viewport"
    severity: medium

  - id: robots_sitemap
    type: file
    urls:
      - "https://www.virtauto.de/robots.txt"
      - "https://www.virtauto.de/sitemap.xml"
    must_exist: true
    severity: high
    rollback_on: true

  - id: status_files_exist
    type: file
    paths:
      - /status/status.json
      - /status/agents.html
    must_exist: true
    severity: high
    rollback_on: true

